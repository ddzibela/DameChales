@namespace DameChales.Web.App.Shared
@using DameChales.Web.App.Resources.Texts
@using DameChales.Common.Models
@using DameChales.Common.Enums
@using DameChales.Common
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<RestaurantsDetailPageResources> RestaurantLocalizer
@inject IStringLocalizer<FoodListPageResources> FoodLocalizer
@inject IStringLocalizer<FoodEditPageResources> FoodEditPageLocalizer
@inject IStringLocalizer<RestaurantsEditPageResources> RestaurantEditPageLocalizer

<EditForm Model="@NameRegex">

    <h5 class="card-title">@RestaurantLocalizer["Filter"]</h5>
    <!--ALERGENS-->
    <div class="form-group">

        @foreach (var alergen in Enum.GetNames(typeof(Common.Enums.Alergens)))
        {
            Common.Enums.Alergens a = (Common.Enums.Alergens)Enum.Parse(typeof(Common.Enums.Alergens), alergen);
            bool isChecked = false;

            @if (Alergens.Contains(a))
            {
                isChecked = true;

            }

            <div class="form-check form-check-inline">
                <input type="checkbox" class="form-check-input" @onchange="eventArgs => { CheckboxClicked(alergen, eventArgs.Value); }" checked="@isChecked" />
                @RestaurantLocalizer[alergen.ToString()]
            </div>
        }

        @functions {
        void CheckboxClicked(string alergenStr, object checkedValue)
        {
            if ((bool)checkedValue)
            {
                Alergens.Add((Common.Enums.Alergens)Enum.Parse(typeof(Common.Enums.Alergens), alergenStr));
            }
            else
            {

                Alergens.Remove((Common.Enums.Alergens)Enum.Parse(typeof(Common.Enums.Alergens), alergenStr));
            }
        }
        }
    </div>
    <!--END ALERGENS-->
    <div class="input-group-pb2">
        <div style="float: left; width: 45%">
            <label class="w-100 font-weight-bold">
                @FoodEditPageLocalizer["Name_FormLabel"]
                <InputText @bind-Value="NameRegex" class="form-control" aria-describedby="basic-addon2" />
            </label>
        </div>
        <div style="float: left; width: 50%">
            <label class="w-100 font-weight-bold">
                @FoodEditPageLocalizer["Description_FormLabel"]
                <InputTextArea @bind-Value="DescRegex" class="form-control" aria-describedby="basic-addon2" />
            </label>
        </div>
        <div class="input-group-btn">
            <button type="submit" class="btn btn-success" @onclick="@Filter">
                @FoodLocalizer["search"]
            </button>
        </div>
    </div>

</EditForm>
